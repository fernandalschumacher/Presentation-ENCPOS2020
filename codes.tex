% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  ignorenonframetext,
]{beamer}
\usepackage{pgfpages}
\setbeamertemplate{caption}[numbered]
\setbeamertemplate{caption label separator}{: }
\setbeamercolor{caption name}{fg=normal text.fg}
\beamertemplatenavigationsymbolsempty
% Prevent slide breaks in the middle of a paragraph
\widowpenalties 1 10000
\raggedbottom
\setbeamertemplate{part page}{
  \centering
  \begin{beamercolorbox}[sep=16pt,center]{part title}
    \usebeamerfont{part title}\insertpart\par
  \end{beamercolorbox}
}
\setbeamertemplate{section page}{
  \centering
  \begin{beamercolorbox}[sep=12pt,center]{part title}
    \usebeamerfont{section title}\insertsection\par
  \end{beamercolorbox}
}
\setbeamertemplate{subsection page}{
  \centering
  \begin{beamercolorbox}[sep=8pt,center]{part title}
    \usebeamerfont{subsection title}\insertsubsection\par
  \end{beamercolorbox}
}
\AtBeginPart{
  \frame{\partpage}
}
\AtBeginSection{
  \ifbibliography
  \else
    \frame{\sectionpage}
  \fi
}
\AtBeginSubsection{
  \frame{\subsectionpage}
}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={EncPos},
  pdfauthor={Fernanda Lang Schumacher},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\newif\ifbibliography
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{caption}
% Make caption package work with longtable
\makeatletter
\def\fnum@table{\tablename~\thetable}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{verbatim}
\usepackage{multicol}

\title{EncPos}
\author{Fernanda Lang Schumacher}
\date{23/11/2020}

\begin{document}
\frame{\titlepage}

\begin{frame}{Motivation: sleepstudy data}
\protect\hypertarget{motivation-sleepstudy-data}{}

\begin{itemize}
\tightlist
\item
  The average reaction time per day for subjects was evaluated by
  Gregory et al.~(2003) in a sleep deprivation study.
\item
  On day 0 the subjects had their normal amount of sleep and starting
  that night they were restricted to 3 hours of sleep per night for 9
  days, and the reaction time basead on a series of tests was measured
  on each day for each subject.
\item
  The data are avaliable at the R package \emph{lme4}.
\end{itemize}

\end{frame}

\begin{frame}{Motivation: sleepstudy data}
\protect\hypertarget{motivation-sleepstudy-data-1}{}

\begin{center}\includegraphics[width=0.85\linewidth]{codes_files/figure-beamer/data-1} \end{center}

\end{frame}

\begin{frame}{Introduction}
\protect\hypertarget{introduction}{}

\begin{itemize}
\tightlist
\item
  Bullet 1
\item
  Bullet 2
\item
  Bullet 3
\end{itemize}

\end{frame}

\begin{frame}{Linear mixed models}
\protect\hypertarget{linear-mixed-models}{}

\end{frame}

\begin{frame}[fragile]{Fitting a LMM to the sleepstudy dataset}
\protect\hypertarget{fitting-a-lmm-to-the-sleepstudy-dataset}{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fitlme <-}\StringTok{ }\KeywordTok{lme}\NormalTok{(Reaction}\OperatorTok{~}\NormalTok{Days,}\DataTypeTok{data=}\NormalTok{sleepstudy,}
            \DataTypeTok{random=}\OperatorTok{~}\NormalTok{Days}\OperatorTok{|}\NormalTok{Subject)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.7\linewidth]{codes_files/figure-beamer/fit1plot-1} \end{center}

\end{frame}

\begin{frame}{Model formulation}
\protect\hypertarget{model-formulation}{}

\end{frame}

\begin{frame}{Within-subject dependence structures}
\protect\hypertarget{within-subject-dependence-structures}{}

\end{frame}

\begin{frame}{Tools for model evaluation}
\protect\hypertarget{tools-for-model-evaluation}{}

\end{frame}

\begin{frame}[fragile]{The \texttt{R} package \emph{skewlmm}}
\protect\hypertarget{the-package}{}

\begin{itemize}
\item
  The package \emph{skewlmm} implemets an EM-type algorithm in
  \texttt{R} using S3 class, containing methods for estimating and
  predicting the SM(S)N-LMM.
\item
  It has an user-friendly interface with generic \texttt{R} functions
  \texttt{print}, \texttt{summary}, \texttt{plot}, \texttt{fitted},
  \texttt{residuals} and \texttt{predict} implemented.
\item
  The main functions in the package are \texttt{smsn.lmm()} and
  \texttt{smn.lmm()}, which fit a SMSN-LMM and a SMN-LMM, respectively.
\end{itemize}

\end{frame}

\begin{frame}[fragile]{The \texttt{R} package \emph{skewlmm}}
\protect\hypertarget{the-package-1}{}

The basic syntax of these functions is as follows:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{smsn.lmm}\NormalTok{(data, formFixed, groupVar, formRandom, }
\NormalTok{         depStruct, distr, ...)}
\KeywordTok{smn.lmm}\NormalTok{(data, formFixed, groupVar, formRandom, }
\NormalTok{        depStruct, distr, ...)}
\end{Highlighting}
\end{Shaded}

where

\begin{itemize}
\item
  \texttt{data}: A data frame containing all the variables to be used in
  the model.
\item
  \texttt{formFixed}: A two-sided linear formula object describing the
  fixed effects part of the model.
\item
  \texttt{groupVar}: A character containing the name of the variable
  which represents the subjects or groups in data.
\end{itemize}

\end{frame}

\begin{frame}[fragile]

\begin{itemize}
\item
  \texttt{formRandom}: A one-sided linear formula object describing the
  random effects part of the model.
\item
  \texttt{depStruct}: A character indicating which dependence structure
  should be used.
\item
  \texttt{distr}: A character indicating which distribution should be
  used.\pause
\end{itemize}

Some other useful arguments:

\begin{itemize}
\item
  \texttt{timeVar}: A character containing the name of the variable
  which represents the time in data.
\item
  \texttt{pAR}: The order of the autoregressive process that should be
  used (if depStruct=``ARp'').
\item
  \texttt{initialValues}: A named list containing initial parameter
  values.
\end{itemize}

\end{frame}

\begin{frame}[fragile]

The functions return an object of the class \texttt{SMSN} and
\texttt{SMN}, respectively, containing a list of elements, and the
following methods/functions are available to these classes:

\begin{itemize}
\item
  \texttt{print}
\item
  \texttt{summary}
\item
  \texttt{fitted}
\item
  \texttt{plot}
\item
  \texttt{predict}
\item
  \texttt{residuals}
\item
  \texttt{ranef}
\item
  \texttt{acfresid}
\item
  \texttt{healy.plot}
\item
  \texttt{lr.test}
\item
  \texttt{mahalDist} 
\end{itemize}

\end{frame}

\begin{frame}[fragile]{Example: sleepstudy data}
\protect\hypertarget{example-sleepstudy-data}{}

\tiny

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#fitting a (CI)-SMN-LMM, default is distr='norm'}
\NormalTok{fit0<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}
              \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}\DataTypeTok{quiet =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Linear mixed models with distribution norm and dependency structure CI 
## Call:
## smn.lmm(data = sleepstudy, formFixed = Reaction ~ Days, groupVar = "Subject", 
##     formRandom = ~Days, quiet = T)
## 
## Fixed:Reaction ~ Days
## Random:~Days
##   Estimated variance (D):
##             (Intercept)     Days
## (Intercept)   560.68002 11.91827
## Days           11.91827 32.52525
## 
## Estimated parameters:
##      (Intercept)    Days   sigma2  Dsqrt1 Dsqrt2 Dsqrt3
##         251.4051 10.4673 655.4400 23.6752 0.4059 5.6886
## s.e.      7.2257  1.5541  31.3784 10.0856 1.7514 1.4270
## 
## Model selection criteria:
##   logLik     AIC      BIC
##  -875.97 1763.94 1783.098
## 
## Number of observations: 180 
## Number of groups: 18
\end{verbatim}

\end{frame}

\begin{frame}[fragile]

\tiny

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#fitting a (CI)-SMSN-LMM, default is distr='sn'}
\NormalTok{fitskew0<-}\KeywordTok{smsn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}
              \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}\DataTypeTok{quiet =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fitskew0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Linear mixed models with distribution sn and dependency structure CI 
## Call:
## smsn.lmm(data = sleepstudy, formFixed = Reaction ~ Days, groupVar = "Subject", 
##     formRandom = ~Days, quiet = T)
## 
## Fixed:Reaction ~ Days
## Random:~Days
##   Estimated variance (D):
##             (Intercept)     Days
## (Intercept)  1432.65701 35.22718
## Days           35.22718 33.76855
## 
## Estimated parameters:
##      (Intercept)    Days   sigma2  Dsqrt1 Dsqrt2 Dsqrt3 lambda1 lambda2
##         251.4073 10.4657 652.6598 37.8418 0.8080 5.7546 -4.2917 -0.2477
## s.e.     11.6328  2.1610  32.7878 28.9642 5.2063 1.6311      NA      NA
## 
## Model selection criteria:
##    logLik      AIC      BIC
##  -875.354 1766.709 1792.253
## 
## Number of observations: 180 
## Number of groups: 18
\end{verbatim}

\end{frame}

\begin{frame}[fragile]{Changing the distribution}
\protect\hypertarget{changing-the-distribution}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit1<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}\DataTypeTok{distr =} \StringTok{'t'}\NormalTok{,}
              \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}\DataTypeTok{quiet =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fitskew1<-}\KeywordTok{smsn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}\DataTypeTok{distr =} \StringTok{'st'}\NormalTok{,}
                  \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}\DataTypeTok{quiet =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit2<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}\DataTypeTok{distr =} \StringTok{'sl'}\NormalTok{,}
              \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}\DataTypeTok{quiet =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fitskew2<-}\KeywordTok{smsn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}\DataTypeTok{distr =} \StringTok{'ssl'}\NormalTok{,}
                  \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}\DataTypeTok{quiet =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit3<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}\DataTypeTok{distr =} \StringTok{'cn'}\NormalTok{,}
              \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}\DataTypeTok{quiet =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fitskew3<-}\KeywordTok{smsn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}\DataTypeTok{distr =} \StringTok{'scn'}\NormalTok{,}
                  \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}\DataTypeTok{quiet =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}{Comparing the fitted models}
\protect\hypertarget{comparing-the-fitted-models}{}

\begin{longtable}[]{@{}lrr@{}}
\toprule
distr & AIC & BIC\tabularnewline
\midrule
\endhead
norm & 1763.9 & 1783.1\tabularnewline
sn & 1766.7 & 1792.3\tabularnewline
t & 1737.5 & 1759.8\tabularnewline
st & 1739.8 & 1768.6\tabularnewline
sl & 1736.2 & 1758.5\tabularnewline
ssl & 1738.4 & 1767.2\tabularnewline
cn & 1733.7 & 1759.3\tabularnewline
scn & 1735.9 & 1767.8\tabularnewline
\bottomrule
\end{longtable}

\end{frame}

\begin{frame}[fragile]{Assessing the goodness of fit using a Healy-type
plot}
\protect\hypertarget{assessing-the-goodness-of-fit-using-a-healy-type-plot}{}

\small

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{grid.arrange}\NormalTok{(}\KeywordTok{healy.plot}\NormalTok{(fit0),}
            \KeywordTok{healy.plot}\NormalTok{(fit1),}
            \KeywordTok{healy.plot}\NormalTok{(fit2),}
            \KeywordTok{healy.plot}\NormalTok{(fit3))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.85\linewidth]{codes_files/figure-beamer/healy1-1} \end{center}

\end{frame}

\begin{frame}[fragile]{LR test for \(H_0: \lambda=0\) in the CN-LMM}
\protect\hypertarget{lr-test-for-h_0-lambda0-in-the-cn-lmm}{}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lr.test}\NormalTok{(fitskew3,fit3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Model selection criteria:
##            logLik      AIC      BIC
## fitskew3 -857.926 1735.851 1767.781
## fit3     -858.861 1733.722 1759.266
## 
##     Likelihood-ratio Test
## 
## chi-square statistics =  1.871248 
## df =  2 
## p-value =  0.392341 
## 
## The null hypothesis that both models represent the 
## data equally well is not rejected at level  0.05
\end{verbatim}

\end{frame}

\begin{frame}[fragile]{Computing the ACF of the residuals from CN-LMM}
\protect\hypertarget{computing-the-acf-of-the-residuals-from-cn-lmm}{}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{acfresid}\NormalTok{(fit3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    lag         ACF n.used
## 1    0  1.00000000    180
## 2    1  0.19793878    162
## 3    2 -0.07329748    144
## 4    3 -0.21972223    126
## 5    4 -0.06519806    108
## 6    5 -0.13723727     90
## 7    6 -0.27485055     72
## 8    7 -0.08778128     54
## 9    8  0.19912222     36
## 10   9  0.58707921     18
\end{verbatim}

\end{frame}

\begin{frame}[fragile]{Plotting the ACF (CI-CN-LMM)}
\protect\hypertarget{plotting-the-acf-ci-cn-lmm}{}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{acfresid}\NormalTok{(fit3,}\DataTypeTok{calcCI =}\NormalTok{ T,}\DataTypeTok{maxLag =} \DecValTok{6}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.85\linewidth]{codes_files/figure-beamer/fit6-1} \end{center}

\end{frame}

\begin{frame}[fragile]{Fitting an AR(p)-SMN-LMM}
\protect\hypertarget{fitting-an-arp-smn-lmm}{}

\small

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#sl}
\NormalTok{fit2ar1<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}
                 \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}
                 \DataTypeTok{distr=}\StringTok{"sl"}\NormalTok{,}\DataTypeTok{depStruct =} \StringTok{"ARp"}\NormalTok{,}\DataTypeTok{pAR=}\DecValTok{1}\NormalTok{,}\DataTypeTok{quiet=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit2ar2<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}
                 \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}
                 \DataTypeTok{distr=}\StringTok{"sl"}\NormalTok{,}\DataTypeTok{depStruct =} \StringTok{"ARp"}\NormalTok{,}\DataTypeTok{pAR=}\DecValTok{2}\NormalTok{,}\DataTypeTok{quiet=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#cn}
\NormalTok{fit3ar1<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}
                 \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}
                 \DataTypeTok{distr=}\StringTok{"cn"}\NormalTok{,}\DataTypeTok{depStruct =} \StringTok{"ARp"}\NormalTok{,}\DataTypeTok{pAR=}\DecValTok{1}\NormalTok{,}\DataTypeTok{quiet=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit3ar2<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}
                 \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}
                 \DataTypeTok{distr=}\StringTok{"cn"}\NormalTok{,}\DataTypeTok{depStruct =} \StringTok{"ARp"}\NormalTok{,}\DataTypeTok{pAR=}\DecValTok{2}\NormalTok{,}\DataTypeTok{quiet=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]{Fitting a DEC-SMN-LMM}
\protect\hypertarget{fitting-a-dec-smn-lmm}{}

\small

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#sl}
\NormalTok{fit2dec<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}
                 \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}
                 \DataTypeTok{distr=}\StringTok{"sl"}\NormalTok{,}\DataTypeTok{depStruct =} \StringTok{"DEC"}\NormalTok{,}\DataTypeTok{quiet=}\NormalTok{T,}
                 \DataTypeTok{timeVar =} \StringTok{'Days'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#cn}
\NormalTok{fit3dec<-}\KeywordTok{smn.lmm}\NormalTok{(}\DataTypeTok{data=}\NormalTok{sleepstudy,}\DataTypeTok{formFixed =}\NormalTok{ Reaction}\OperatorTok{~}\NormalTok{Days,}
                 \DataTypeTok{formRandom =} \OperatorTok{~}\NormalTok{Days,}\DataTypeTok{groupVar =} \StringTok{"Subject"}\NormalTok{,}
                 \DataTypeTok{distr=}\StringTok{"cn"}\NormalTok{,}\DataTypeTok{depStruct =} \StringTok{"DEC"}\NormalTok{,}\DataTypeTok{quiet=}\NormalTok{T,}
                 \DataTypeTok{timeVar =} \StringTok{'Days'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Since the data are equally spaced and sorted by time, the use of
\texttt{timeVar} in here is optional (the function will use the position
if \texttt{timeVar} is not provided).

\end{frame}

\begin{frame}{Comparing the fitted models}
\protect\hypertarget{comparing-the-fitted-models-1}{}

\begin{longtable}[]{@{}llrr@{}}
\toprule
distr & depStruct & AIC & BIC\tabularnewline
\midrule
\endhead
sl & CI & 1736.2 & 1758.5\tabularnewline
sl & AR1 & 1716.9 & 1742.5\tabularnewline
sl & AR2 & 1717.3 & 1746.0\tabularnewline
sl & DEC & 1718.2 & 1746.9\tabularnewline
cn & CI & 1733.7 & 1759.3\tabularnewline
cn & AR1 & 1715.5 & 1744.3\tabularnewline
cn & AR2 & 1714.9 & 1746.9\tabularnewline
cn & DEC & 1716.3 & 1748.2\tabularnewline
\bottomrule
\end{longtable}

\end{frame}

\begin{frame}[fragile]{Healy plot for the AR(\(p\))-SMN-LMM}
\protect\hypertarget{healy-plot-for-the-arp-smn-lmm}{}

\small

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{grid.arrange}\NormalTok{(}\KeywordTok{healy.plot}\NormalTok{(fit2ar1),}
            \KeywordTok{healy.plot}\NormalTok{(fit3ar1),}
            \KeywordTok{healy.plot}\NormalTok{(fit3ar2),}\DataTypeTok{ncol=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.85\linewidth]{codes_files/figure-beamer/healy2-1} \end{center}

\end{frame}

\begin{frame}[fragile]{LR test for \(H_0: \phi_2=0\) in the CN-LMM}
\protect\hypertarget{lr-test-for-h_0-phi_20-in-the-cn-lmm}{}

\small

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lr.test}\NormalTok{(fit3ar1,fit3ar2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Model selection criteria:
##           logLik      AIC      BIC
## fit3ar1 -848.760 1715.520 1744.257
## fit3ar2 -847.463 1714.925 1746.855
## 
##     Likelihood-ratio Test
## 
## chi-square statistics =  2.594949 
## df =  1 
## p-value =  0.1072049 
## 
## The null hypothesis that both models represent the 
## data equally well is not rejected at level  0.05
\end{verbatim}

\end{frame}

\begin{frame}[fragile]{ACF plot for AR(1)-SMN-LMM}
\protect\hypertarget{acf-plot-for-ar1-smn-lmm}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{grid.arrange}\NormalTok{(}\KeywordTok{plot}\NormalTok{(}\KeywordTok{acfresid}\NormalTok{(fit2ar1,}\DataTypeTok{calcCI =}\NormalTok{ T,}\DataTypeTok{maxLag =} \DecValTok{6}\NormalTok{))}\OperatorTok{+}
\StringTok{               }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"AR(1)-SL-LMM"}\NormalTok{),}
             \KeywordTok{plot}\NormalTok{(}\KeywordTok{acfresid}\NormalTok{(fit3ar1,}\DataTypeTok{calcCI =}\NormalTok{ T,}\DataTypeTok{maxLag =} \DecValTok{6}\NormalTok{))}\OperatorTok{+}
\StringTok{               }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"AR(1)-CN-LMM"}\NormalTok{), }\DataTypeTok{ncol=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.85\linewidth]{codes_files/figure-beamer/acf1-1} \end{center}

\end{frame}

\begin{frame}[fragile]{Fitted models}
\protect\hypertarget{fitted-models}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#sl}
\KeywordTok{cbind}\NormalTok{(fit2ar1}\OperatorTok{$}\NormalTok{theta,fit2ar1}\OperatorTok{$}\NormalTok{std.error) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{knitr}\OperatorTok{::}\KeywordTok{kable}\NormalTok{(}\DataTypeTok{digits =} \DecValTok{2}\NormalTok{,}\DataTypeTok{col.names =} \KeywordTok{c}\NormalTok{(}\StringTok{'estimate'}\NormalTok{,}\StringTok{'std.error'}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrr@{}}
\toprule
& estimate & std.error\tabularnewline
\midrule
\endhead
(Intercept) & 251.55 & 7.56\tabularnewline
Days & 9.81 & 1.66\tabularnewline
sigma2 & 266.24 & 63.43\tabularnewline
phiAR1 & 0.57 & 0.14\tabularnewline
Dsqrt1 & 14.21 & 10.15\tabularnewline
Dsqrt2 & 2.58 & 4.16\tabularnewline
Dsqrt3 & 2.17 & 6.45\tabularnewline
nu1 & 1.52 & NA\tabularnewline
\bottomrule
\end{longtable}

\end{frame}

\begin{frame}[fragile]

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#cn}
\KeywordTok{cbind}\NormalTok{(fit3ar1}\OperatorTok{$}\NormalTok{theta,fit3ar1}\OperatorTok{$}\NormalTok{std.error) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{knitr}\OperatorTok{::}\KeywordTok{kable}\NormalTok{(}\DataTypeTok{digits =} \DecValTok{2}\NormalTok{,}\DataTypeTok{col.names =} \KeywordTok{c}\NormalTok{(}\StringTok{'estimate'}\NormalTok{,}\StringTok{'std.error'}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrr@{}}
\toprule
& estimate & std.error\tabularnewline
\midrule
\endhead
(Intercept) & 252.55 & 7.02\tabularnewline
Days & 9.99 & 1.57\tabularnewline
sigma2 & 417.84 & 78.77\tabularnewline
phiAR1 & 0.56 & 0.14\tabularnewline
Dsqrt1 & 16.90 & 11.82\tabularnewline
Dsqrt2 & 2.82 & 4.76\tabularnewline
Dsqrt3 & 2.89 & 6.31\tabularnewline
nu1 & 0.12 & NA\tabularnewline
nu2 & 0.16 & NA\tabularnewline
\bottomrule
\end{longtable}

\end{frame}

\begin{frame}[fragile]{Mahalanobis distance for AR(1)-SMN-LMM}
\protect\hypertarget{mahalanobis-distance-for-ar1-smn-lmm}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{grid.arrange}\NormalTok{(}\KeywordTok{plot}\NormalTok{(}\KeywordTok{mahalDist}\NormalTok{(fit2ar1),}\DataTypeTok{fitobject =}\NormalTok{ fit2ar1,}\DataTypeTok{nlabels =} \DecValTok{0}\NormalTok{)}\OperatorTok{+}
\StringTok{               }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{'AR(1)-SL-LMM'}\NormalTok{),}
             \KeywordTok{plot}\NormalTok{(}\KeywordTok{mahalDist}\NormalTok{(fit3ar1),}\DataTypeTok{fitobject =}\NormalTok{ fit3ar1,}\DataTypeTok{nlabels =} \DecValTok{0}\NormalTok{)}\OperatorTok{+}
\StringTok{               }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{'AR(1)-CN-LMM'}\NormalTok{),}
             \DataTypeTok{ncol=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.8\linewidth]{codes_files/figure-beamer/mahal1-1} \end{center}

\end{frame}

\begin{frame}[fragile]{Mahalanobis distance versus \(\hat{u}\) for
AR(1)-SMN-LMM}
\protect\hypertarget{mahalanobis-distance-versus-hatu-for-ar1-smn-lmm}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{grid.arrange}\NormalTok{(}\KeywordTok{qplot}\NormalTok{(}\KeywordTok{mahalDist}\NormalTok{(fit2ar1),fit2ar1}\OperatorTok{$}\NormalTok{uhat)}\OperatorTok{+}\KeywordTok{theme_minimal}\NormalTok{()}\OperatorTok{+}
\StringTok{               }\KeywordTok{ylab}\NormalTok{(}\StringTok{"uhat"}\NormalTok{)}\OperatorTok{+}\KeywordTok{xlab}\NormalTok{(}\StringTok{"Mahalanobis distance"}\NormalTok{)}\OperatorTok{+}
\StringTok{               }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{'AR(1)-SL-LMM'}\NormalTok{),}
             \KeywordTok{qplot}\NormalTok{(}\KeywordTok{mahalDist}\NormalTok{(fit3ar1),fit3ar1}\OperatorTok{$}\NormalTok{uhat)}\OperatorTok{+}\KeywordTok{theme_minimal}\NormalTok{()}\OperatorTok{+}
\StringTok{               }\KeywordTok{ylab}\NormalTok{(}\StringTok{"uhat"}\NormalTok{)}\OperatorTok{+}\KeywordTok{xlab}\NormalTok{(}\StringTok{"Mahalanobis distance"}\NormalTok{)}\OperatorTok{+}
\StringTok{               }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{'AR(1)-CN-LMM'}\NormalTok{),}
             \DataTypeTok{ncol=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.8\linewidth]{codes_files/figure-beamer/mahal2-1} \end{center}

\end{frame}

\begin{frame}[fragile]{Plot fitted models}
\protect\hypertarget{plot-fitted-models}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{grid.arrange}\NormalTok{(}\KeywordTok{plot}\NormalTok{(fit2ar1,}\DataTypeTok{type =} \StringTok{"normalized"}\NormalTok{)}\OperatorTok{+}\KeywordTok{ggtitle}\NormalTok{(}\StringTok{'AR(1)-SL-LMM'}\NormalTok{),}
             \KeywordTok{plot}\NormalTok{(fit3ar1,}\DataTypeTok{type =} \StringTok{"normalized"}\NormalTok{)}\OperatorTok{+}\KeywordTok{ggtitle}\NormalTok{(}\StringTok{'AR(1)-CN-LMM'}\NormalTok{),}
             \DataTypeTok{ncol=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.85\linewidth]{codes_files/figure-beamer/extra1-1} \end{center}

\end{frame}

\begin{frame}[fragile]{Prediction of future measurements}
\protect\hypertarget{prediction-of-future-measurements}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{tail}\NormalTok{(sleepstudy,}\DataTypeTok{n=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Reaction Days Subject
## 178 343.2199    7     372
## 179 369.1417    8     372
## 180 364.1236    9     372
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predData <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Reaction=}\OtherTok{NA}\NormalTok{,}\DataTypeTok{Days=}\DecValTok{10}\OperatorTok{:}\DecValTok{11}\NormalTok{,}\DataTypeTok{Subject=}\StringTok{"372"}\NormalTok{)}
\KeywordTok{predict}\NormalTok{(fit2ar1,}\DataTypeTok{newData =}\NormalTok{ predData)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   groupVar Days    ypred
## 1      372   10 377.0998
## 2      372   11 389.5745
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{predict}\NormalTok{(fit3ar1,}\DataTypeTok{newData =}\NormalTok{ predData)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   groupVar Days    ypred
## 1      372   10 377.1056
## 2      372   11 389.5576
\end{verbatim}

\end{frame}

\begin{frame}{References}
\protect\hypertarget{references}{}

\begin{itemize}
\tightlist
\item
  Gregory Belenky, Nancy J. Wesensten, David R. Thorne, Maria L. Thomas,
  Helen C. Sing, Daniel P. Redmond, Michael B. Russo and Thomas J.
  Balkin (2003) Patterns of performance degradation and restoration
  during sleep restriction and subsequent recovery: a sleep
  dose-response study. Journal of Sleep Research 12, 1--12.
\end{itemize}

\end{frame}

\end{document}
